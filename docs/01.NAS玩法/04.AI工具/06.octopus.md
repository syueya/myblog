

官方文档：https://github.com/bestruirui/octopus


## 部署

```
services:
  octopus:
    image: bestrui/octopus
    container_name: octopus
    restart: unless-stopped
    ports:
       - 8080:8080 # 冒号前面的8080可以改成未被占用的
    volumes:      
       - ./data:/app/data
```



**1、配置项**

配置文件默认位于 data/config.json ，并在首次启动时自动生成。所有配置选项也可以通过环境变量覆盖，格式为 OCTOPUS_ + 配置路径（用 _ 连接）：

|环境变量	|配置选项|说明|默认值|
|:--|:--|:--|:--|
|OCTOPUS_SERVER_PORT |服务器端口	|server.port|8080|
|OCTOPUS_SERVER_HOST	|监听地址|server.host|0.0.0.0|
|OCTOPUS_DATABASE_TYPE	|数据库类型|database.type|sqlite|
|OCTOPUS_DATABASE_PATH	|数据库连接地址|database.path|data/data.db|
|OCTOPUS_LOG_LEVEL	|日志级别|log.level|info|
|OCTOPUS_GITHUB_PAT	|用于在获取最新版本时限制速率（可选）|||
|OCTOPUS_RELAY_MAX_SSE_EVENT_SIZE	|最大 SSE 事件大小（可选）|||


**2、数据库**

支持三种数据库类型：SQLite（默认，不需额外配置）、MySQL、PostgreSQL。
- SQLite是默认数据库，不需要额外配置。
- MySQL和PostgreSQL需要手动创建数据库。应用程序将自动创建表格结构。
```
# 默认SQLite 配置示例
{
  "database": {
    "type": "sqlite",
    "path": "data/data.db"
  }
}


# MySQL 配置示例

{
  "database": {
    "type": "mysql",
    "path": "root:password@tcp(127.0.0.1:3306)/octopus"
  }
}

# PostgreSQL 配置示例：

{
  "database": {
    "type": "postgres",
    "path": "postgresql://user:password@localhost:5432/octopus?sslmode=disable"
  }
}
```



### 基础设置

首次启动后，使用IP:端口访问页面，使用默认的用户名admin，密码 admin 登录管理面板：

![img](./img/octopus-01.png)


登陆成功后，点击设置页面，在账户设置栏修改用户名和密码。如果需要使用域名登陆，还得在系统栏设置CORS跨域白名单，否则登陆会提示`登录失败,请检查登录凭据`。

![img](./img/octopus-02.png)


### 渠道

1、点击渠道菜单，会展示所有的渠道。右上角的+按钮可以添加新的渠道。

![img](./img/octopus-03.png)


2、添加渠道

- 填写渠道名称，选择渠道类型
- 填写渠道的地址和 API 密钥。
- 输入模型名称或者点击刷新按钮获取模型列表
- 高级设置和要不要使用代理看需求
- 点击创建按钮

![img](./img/octopus-04.png)


3、渠道类型及请求路径

|渠道类型	|自动附加路径	|Base URL	|完整请求 URL 示例|
|:--|:--|:--|:--|
|OpenAI Chat	|/chat/completions |	https://api.openai.com/v1	|https://api.openai.com/v1/chat/completions|
|OpenAI Responses |	/responses |	https://api.openai.com/v1 | https://api.openai.com/v1/responses |
|Anthropic | /messages	|https://api.anthropic.com/v1 | https://api.anthropic.com/v1/messages |
|Gemini 	|/models/:model:generateContent | https://generativelanguage.googleapis.com/v1beta |https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent|


## 分组

组可以将多个渠道模型汇总为一个统一的外部模型名称。调用 API 时，将 model 参数设置为组名即可。

1、点击组菜单，会展示所有的组。右上角的+按钮可以添加新的组。

![img](./img/octopus-05.png)

2、添加组
- 填写分组名称，可以留空按分组名称模糊匹配，设置首字超时时间（单位秒）
- 选择负载均衡模式
- 点击自动添加按钮，系统会自动将所有可用的模型添加到已选模型中
- 点击创建按钮
![img](./img/octopus-06.png)

>负载平衡模式：
>- 轮询：为每个请求依次循环通道
>- 随机：随机选择一个可用信道
>- 加权分配：根据配置的通道权重分配请求
>- 故障转移：优先处理高优先级通道，只有在故障时才切换到低优先级通道


## 日志

可以点击日志菜单查看所有请求的日志。

![img](./img/octopus-07.png)


## API密钥

在设置菜单里找到API密钥栏，可以添加密钥。

![img](./img/octopus-08.png)

然后就可以在CherryStuido、Kelivo等软件里使用Octopus了。

![img](./img/octopus-09.png)
