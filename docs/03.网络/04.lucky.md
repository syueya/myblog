---
title: lucky
date: null
permalink: /network/lucky/
categories: 
  - 网络
tags: 
  - 
---

lucky是一个网络设置小工具组，支持可视化操作，自带 WebUI 后台。支持 IPv6/IPv4 端口转发、反向代理、动态域名、语音助手网络唤醒、IPv4 内网穿透、计划任务和自动证书等多项功能。

## 容器部署

1.首先我们打开绿联云，来到Docker拉取镜像：gdy666/lucky，安装最新版本。

![img](./img/0401.png)


2.点击创建容器，勾选创建后启动容器，点击下一步。

![img](./img/0402.png)

3.重启策略选择容器退出时总是重启容器

![img](./img/0403.png)

4.网络选择：host

![img](./img/0404.png)

5.在Docker目录下新建个goodlucky文件夹设为挂载文件夹，挂载路径为/goodluck，类型设置读写。

![img](./img/0405.png)

6.端口默认为16601， 然后直接点下一步，然后点完成启动应用.

![img](./img/0406.png)

7.打开浏览器输出你的NAS的IP加端口16601进入设置界面，默认账户为666密码为666

![img](./img/0407.png)

8.然后进入网页

![img](./img/0408.png)

## 配置

### 1、修改账户密码

设置-登录验证设置修改账户密码。

![img](./img/0409.png)

### 2、域名解析

点击动态域名-添加DDNS任务，进行域名解析。

- 除非特殊需求一般简易模式就够你用了，不要点定制模式
- DNS服务商根据你的服务商选择，这边我们用的是阿里云，并输入对应的AccessKey ID和Secret。
- 公网IP类型根据你自身是IPV4还是IPV6选择，如果是IPV4就选择接口获取，如果是IPV6就选择网卡获取（你两个都要解析需要创建两个）；域名列表里假如你的域名是abc.com，那么下面填写abc.com和*.abc.com

![img](./img/0410.png)

填写完成等一会，会出现同步结果，如果不一致会失败，自查原因

![img](./img/0411.png)

### 3、SSL证书

点击安全管理-添加证书
- 添加方式选择ACME
- 证书颁发机构选择Let's Encrypt
- DNS服务商选择阿里云
- 域名还是如上填写abc.com和*.abc.com
- ID和KEY是阿里云获取的
- 邮箱是自己的邮箱，其他全部默认。

![img](./img/0412.png)

保存后等一会，如果成功后会出现泛域名证书到期时间，这个是自动续签的。

![img](./img/0413.png)

### 4、反代

接着我们来到web服务-添加web服务规则。

1）监听类型tcp4对应IPV4 ，tcp6对应IPV6，你解析的是啥就选啥，监听端口是你反代的端口，这边我们用16666为例（你可以随意，只要端口没被占用重复），需要关闭防火墙自动放行，因为我们是在NAS中使用，用不到这个（大部分地区80/8080/443端口都是封掉的状态，如果443没有被封，你可以监听443，就可以只写二级域名且不需要写监听端口）

![img](./img/0414.png)

2）点击默认子规则，把web服务类型选择重定向，默认目标地址写 https://{host}:{port} 如果你是443监听就写 https://{host}。

![img](./img/0415.png)

3）然后点击下面的添加web服务子规则，以emby为例，这边我们前端域名就是你的二级域名，因为前面我们已经写了*.abc.com，所以这边我们就直接写一个二级就行如：emby.abc.com，后端地址就是你的emby内网地址，比如我的是192.168.31.120:8096，然后保存即可。这里你有几个服务需要外网访问就创建几个子规则，反代监听端口都是一样的，只不过二级域名不同而已。

![img](./img/0416.png)

### 5、转发端口

这边因为我们是在NAS搭建的Lucky所以需要将反代监听端口16666（跟随上面你设置的反代监听端口号）转发出去，然后可以通过https：//emby.abc.com：16666外网访问你的emby了




