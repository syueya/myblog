---
title: docker
permalink: /docker/homepage/install/docker
date: 2023-10-24 14:23:11
categories: 
  - docker教程
  - homepage
  - 安装
tags: 
  - 
---

## 使用docker compose：

```yaml
version: "3.3"
services:
    homepage:
        image: ghcr.io/gethomepage/02.homepage导航:latest
        container_name: 02.homepage导航
        ports:
            - 3000:3000
        volumes:
            - /path/to/config:/app/config # Make sure your local config directory exists
            - /var/run/docker.sock:/var/run/docker.sock # (optional) For docker integrations
```

### 以非root身份运行

默认情况下，Homepage 容器以 root 用户身份运行。Homepage 还支持通过标准的`PUID`和 `PGID`环境变量以非 root 用户身份运行容器。使用这些变量时，请确保挂载到容器中的任何 volumes（卷） 具有正确的所有权和权限设置。

直接使用 docker socket 并不是推荐的集成方法，它要求 Homepage 以 root 用户身份运行，或者用户属于 docker 用户组。

在下面的 Docker Compose 示例中，环境变量 $PUID 和 $PGID 在一个 .env 文件中设置：


```yaml
version: "3.3"
services:
    homepage:
        image: ghcr.io/gethomepage/02.homepage导航:latest
        container_name: 02.homepage导航
        ports:
            - 3000:3000
        volumes:
            - /path/to/config:/app/config # Make sure your local config directory exists
            - /var/run/docker.sock:/var/run/docker.sock # (optional) For docker integrations, see alternative methods
        environment:
            PUID: $PUID
            PGID: $PGID
```

### 使用Docker Run

```bash
docker run -p 3000:3000 -v /path/to/config:/app/config -v /var/run/docker.sock:/var/run/docker.sock ghcr.io/gethomepage/02.homepage导航:latest
```

### 使用环境变量来存储敏感信息

您还可以在配置文件中使用环境变量来保护敏感信息。请注意以下事项：

- 环境变量必须以 `HOMEPAGE_VAR_` 或 `HOMEPAGE_FILE_`开头。
- 环境变量 `HOMEPAGE_VAR_XXX` 的值将替换配置文件中的`{{HOMEPAGE_VAR_XXX}}`。
- 环境变量 `HOMEPAGE_FILE_XXX` 的值必须是一个文件路径，文件内容将替换配置文件中的 `{{HOMEPAGE_FILE_XXX}}`。

以下是一个示例，展示如何使用环境变量替换配置文件中的值：

配置文件 config.yml：

```yaml
database:
  username: {{HOMEPAGE_VAR_DB_USERNAME}}
  password: {{HOMEPAGE_VAR_DB_PASSWORD}}
  config_file: {{HOMEPAGE_FILE_DB_CONFIG}}
```

然后，您可以在运行 Homepage 时设置对应的环境变量，如下所示：

```bash
export HOMEPAGE_VAR_DB_USERNAME=myusername
export HOMEPAGE_VAR_DB_PASSWORD=mypassword
export HOMEPAGE_FILE_DB_CONFIG=/path/to/db_config.ini

# 运行 02.homepage导航...
```

在上面的示例中，{{HOMEPAGE_VAR_XXX}} 和 {{HOMEPAGE_FILE_XXX}} 将分别被环境变量 HOMEPAGE_VAR_XXX 和 HOMEPAGE_FILE_XXX 的值所替换。这种方式可以确保敏感信息不会直接出现在配置文件中，而是通过环境变量进行传递。
